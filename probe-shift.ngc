
o<probe-shift> sub
O180 IF [#<_task> NE 1]
 o<probe-shift> return
O180 ENDIF

; shift all previous probe points
; #13AB => A = stack index, B => 0=X, 1=Y, 2=Z

  #1380 = #1370
  #1381 = #1371
  #1382 = #1372

  #1370 = #1360
  #1371 = #1361
  #1372 = #1362

  #1360 = #1350
  #1361 = #1351
  #1362 = #1352

  #1350 = #1340
  #1351 = #1341
  #1352 = #1342

  #1340 = #1330
  #1341 = #1331
  #1342 = #1332

  #1330 = #1320
  #1331 = #1321
  #1332 = #1322

  #1320 = #1310
  #1321 = #1311
  #1322 = #1312

  #<x1> = #1300
  #<y1> = #1301
  #<z1> = #1302

  #<ox> = #[5201+20*#5220] ; offset x
  #<oy> = #[5202+20*#5220] ; offset y
  #<oz> = #[5203+20*#5220] ; offset y
  #<or> = #[5210+20*#5220] ; r

  #<x2> = [ #<ox> + #<x1>*COS[#<or>] - #<y1>*SIN[#<or>] ]
  #<y2> = [ #<oy> + #<x1>*SIN[#<or>] + #<y1>*COS[#<or>] ]
  #<z2> = [ #<oz> + #<z1> ]

  #1310 = #<x2>
  #1311 = #<y2>
  #1312 = #<z2>

o<probe-shift> endsub
